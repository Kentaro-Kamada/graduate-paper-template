% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  a4paper]{ltjsarticle}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

% パッケージ
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{scalefnt} % 表の大きさいじる

% フォント指定（MS明朝 + Times New Roman）
\usepackage[hiragino-pro]{luatexja-preset}
% \usepackage{luatexja-fontspec}
\setmainfont{Times-New-Roman}
% \setmainjfont[
%     BoldFont           = MS-Gothic,
%     BoldFeatures       = {FakeBold=2},
%     ItalicFont         = MS-Mincho,
%     ItalicFeatures     = {FakeSlant=0.33},
%     BoldItalicFont     = MS-Gothic,
%     BoldItalicFeatures = {FakeBold=2, FakeSlant=0.33}
% ]{MS-Mincho}


% レイアウト設定
\usepackage{geometry}
\geometry{top=3cm, bottom=3cm, left=3cm, right=3cm}

% 文字数マクロ
\makeatletter
\def\mojiparline#1{
    \newcounter{mpl}
    \setcounter{mpl}{#1}
    \@tempdima=\linewidth
    \advance\@tempdima by-\value{mpl}\zw
    \addtocounter{mpl}{-1}
    \divide\@tempdima by \value{mpl}
    \newskip\@tempkskip
    \@tempkskip=\ltjgetparameter{kanjiskip}
    \advance\@tempkskip by \@tempdima
    \ltjsetparameter{kanjiskip=\@tempkskip}
    \advance\parindent by\@tempdima
    }
\makeatother

\def\linesparpage#1{
    \baselineskip=\textheight
    \divide\baselineskip by #1
    }

% 引用文献インデントマクロ定義
\newenvironment{hangall}[1]{\hangindent = #1\zw\everypar{\hangindent = #1\zw}}{}

% 章・節の定義変更
% \renewcommand{\section}{\arabic{section}}
% \renewcommand{\subsection}{\arabic{section}.\arabic{subsection}}


%%%%%% 文末注の設定
% 脚注を文末注に変換
\usepackage{endnotes}
\usepackage{etoolbox}
\let\footnote=\endnote
\renewcommand{\theendnote}{\arabic{endnote})} % 番号を「1)」の形式に
\renewcommand{\notesname}{注} % デフォルトで入る'Note'の文字を'[注]'に変える

% インデント設定
\makeatletter % 「@」を命令中で使用する場合には\makeatletterと\makeatotherではさむ
\renewcommand{\enoteformat}{
  \rightskip\z@ % 右側インデント0文字
  \leftskip=2\zw % 左側インデント全角2文字
  \parindent=1\zw % 先頭インデント全角1文字
  \leavevmode\llap{\hbox{$\theenmark　$}}} % 文末注の前の「1)」を上付きじゃなくする（上付きにするときは\theenmarkを^{\theenmark}とする）
\makeatother

\def\enotesize{\fontsize{10.5bp}{19.15bp}\selectfont} % フォント設定


% stata出力の表中のマクロ
\def\sym#1{\ifmmode^{#1}\else\(^{#1}\)\fi}

\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{longtable}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\author{}
\date{\vspace{-2.5em}}

\begin{document}

\input{表紙}

\thispagestyle{empty}
\setcounter{tocdepth}{2}
\tableofcontents

\clearpage

\setcounter{page}{1}
\fontsize{10.5pt}{21.9pt}\selectfont

\mojiparline{40}

\hypertarget{ux554fux984cux8a2dux5b9a}{%
\section{1　問題設定}\label{ux554fux984cux8a2dux5b9a}}

　あらゆる分野の計量的研究において，コードの管理というのは，誰しもが頭を悩ます問題である。そこで，本稿ではRmarkdownから直接的にpdfを出力し，解析とレポーティングを同時に行うことで，この問題に対する解決法を提示する\footnote{注はこのような形で記入する。執筆規定にもよるが，今回の卒論は章末に注釈を置くことになっているのでこのような形式になっている（詳細は後述）。}。

\theendnotes

\clearpage

\hypertarget{ux5148ux884cux7814ux7a76ux306eux691cux8a0e}{%
\section{2　先行研究の検討}\label{ux5148ux884cux7814ux7a76ux306eux691cux8a0e}}

\hypertarget{wordux3067ux5352ux8ad6ux306eux554fux984cux70b9}{%
\subsection{2.1　wordで卒論の問題点}\label{wordux3067ux5352ux8ad6ux306eux554fux984cux70b9}}

　なぜwordで卒論を書きたくないか。大きな理由は2点ある。
　第一に，レイアウトを考えるのが面倒だからである。wordで執筆する場合，excelでなどから図表をインポートする時に，どこに設置するかのようなことをいちいち考えなければならない\footnote{ただし，今回紹介する方法でも，図表の位置をまったく気にしなくてよくなるわけではない。}。\\
　第二に，コピペ汚染の問題である。計量的研究では，SPSS，stataといった統計ソフトで解析した結果をexcelにコピペし，excel上で罫線を書く，桁数を調整するなどの整形作業を行い，そこからwordにコピペする，という作業が必要である。しかし，この方法では，解析をやり直すたびに，コピペ，図表の整形をやり直さなければならない。\\
　そんなもの，全ての分析が終わった後に図表を挿入すれば良いだけではないか，という声が聞こえてきそうである。しかし，分析が終わったと自分で思っても，予定変更が起こることは頻繁に起こる（一度書いたことがある人ならばわかるはず）。\\
　以上の理由から，wordでの執筆を少なくとも私はやりたくないと考えた。

\hypertarget{ux5148ux884cux4e8bux4f8b}{%
\subsection{2.2　先行事例}\label{ux5148ux884cux4e8bux4f8b}}

　wordを避けて論文を書こうという試みは，社会科学系においてもいくつか存在する。本稿はこれらの先行事例を参考に，自分なりにブラッシュアップしたものを共有している。インスピレーションを与えてくれた先行事例の数々には，篤く感謝申し上げる。\\
　まず，Mugiyama（2017）では，Latexを用いて執筆する方法が紹介されている。Latexは数式に強く，理系の論文では良く使用されている。しかし，本稿の目的は解析とレポーティングの同時化であり，この方法では根本的な解決には至っていない。\\
　次に，Nigimitama（2019）では，本稿と同じくRmarkdownからpdfを出力する方法が紹介されている。本稿はこれをベースに，卒論執筆規定が求める調整を施している。

\theendnotes

\clearpage

\hypertarget{ux57f7ux7b46ux65b9ux6cd5}{%
\section{3　執筆方法}\label{ux57f7ux7b46ux65b9ux6cd5}}

\hypertarget{ux672cux6587}{%
\subsection{3.1　本文}\label{ux672cux6587}}

　本文は普通に書けばよい。\\
　改段落は文末で半角スペース2つ。

\hypertarget{ux8868}{%
\subsection{3.2　表}\label{ux8868}}

　Latex対応は開発途上ではあるが，最近はgtを好んで使っている（複雑な表でなければ\texttt{kable}でも良い）。knitrではキャプションを\texttt{kable}関数の中に書くことで実装できるが，gtはまだ対応していないらしい。詳しくはGithubの\href{https://github.com/rstudio/gt/issues/635}{issue}を参照。卒論ではlevel3の見出しを使ったが，あまりいい方法ではない。\\
　また，1ページに収めたいのに表がデカすぎる場合，\textbackslash scalefntというlatexのパッケージで大きさを変更できる。

\begingroup
\scalefont{0.78}

\hypertarget{ux88681irisux306eux8a18ux8ff0ux7d71ux8a08ux91cf}{%
\subsubsection{表1：irisの記述統計量}\label{ux88681irisux306eux8a18ux8ff0ux7d71ux8a08ux91cf}}

\begin{longtable}{lrrrrr}
\toprule
variables & n & mean & sd & min & max \\ 
\midrule
\multicolumn{6}{l}{setosa} \\ 
\midrule
Petal.Length & 50 & $1.46$ & $0.17$ & 1.0 & 1.9 \\ 
Petal.Width & 50 & $0.25$ & $0.11$ & 0.1 & 0.6 \\ 
Sepal.Length & 50 & $5.01$ & $0.35$ & 4.3 & 5.8 \\ 
Sepal.Width & 50 & $3.43$ & $0.38$ & 2.3 & 4.4 \\ 
\midrule
\multicolumn{6}{l}{versicolor} \\ 
\midrule
Petal.Length & 50 & $4.26$ & $0.47$ & 3.0 & 5.1 \\ 
Petal.Width & 50 & $1.33$ & $0.20$ & 1.0 & 1.8 \\ 
Sepal.Length & 50 & $5.94$ & $0.52$ & 4.9 & 7.0 \\ 
Sepal.Width & 50 & $2.77$ & $0.31$ & 2.0 & 3.4 \\ 
\midrule
\multicolumn{6}{l}{virginica} \\ 
\midrule
Petal.Length & 50 & $5.55$ & $0.55$ & 4.5 & 6.9 \\ 
Petal.Width & 50 & $2.03$ & $0.27$ & 1.4 & 2.5 \\ 
Sepal.Length & 50 & $6.59$ & $0.64$ & 4.9 & 7.9 \\ 
Sepal.Width & 50 & $2.97$ & $0.32$ & 2.2 & 3.8 \\ 
\bottomrule
\end{longtable}

\endgroup

\hypertarget{ux56f3}{%
\subsection{3.3　図}\label{ux56f3}}

　図\ref{fig:fig01}がirisの散布図である。\\
　図の大きさは，\texttt{out.width\textasciigrave{}\textasciigrave{}out.height\textasciigrave{}\textasciigrave{}fig.width\textasciigrave{}\textasciigrave{}fig.height}の4つのパラメータでいじることになる。最初の二つで描画領域を指定し，後の二つで図の比率をいじるイメージ。実際にいろいろやってみて感覚を掴んでほしい。

\begin{figure}
\includegraphics[width=\linewidth,height=20cm]{files/unnamed-chunk-3-1} \caption{irisの散布図 \label{fig:fig01}}\label{fig:unnamed-chunk-3}
\end{figure}

\hypertarget{ux5f15ux7528}{%
\subsection{3.4　引用}\label{ux5f15ux7528}}

　bibtexという便利なものがあるが，今回は利用していない。そもそもこれが便利なのはスタイルファイルなどが公式に提供されている場合であり，latexのlも知らない人が多い社会科学系では，強みを十分に生かすことができない。

\hypertarget{ux6ce8}{%
\subsection{3.5　注}\label{ux6ce8}}

　既に登場しているが，注をつけたい場所に{[}\^{}番号{]}と打ち，その後{[}\^{}番号{]}:文章という形で注釈を書く\footnote{例えばこんな感じ。}。実際に出力される注番号は，ここで記入する番号とは異なり，latex側が勝手に順番・番号振りをやってくれる。注釈を書いたら，theendnotesというコマンドを，注釈を挿入したいところに書く。すると，コマンドまでの注釈がまとめて吐き出される。\\
　なお，デフォルトでは脚注になってしまうので，preambleで，定義を色々いじっている（hnsn1202
2013）。そちらも参照のこと。

\hypertarget{ux6587ux732eux30eaux30b9ux30c8}{%
\subsection{3.6　文献リスト}\label{ux6587ux732eux30eaux30b9ux30c8}}

　引用のところでも書いたが，Bibtexは使用していない。また，引用文献はぶら下げインデントをする慣習があるので，hangallという環境をpreambleで定義している（hakuoku
2018）。

\hypertarget{ux30ecux30a4ux30a2ux30a6ux30c8}{%
\subsection{3.7　レイアウト}\label{ux30ecux30a4ux30a2ux30a6ux30c8}}

　geometryパッケージをpreambleに書き，余白を設定する。\\
　一行当たりの文字数は，\textbackslash mojiparlineというマクロをpreambleで定義している（ebal・北川
2020）。ページ当たりの行数は，\textbackslash linesparpageというマクロをpreambleで定義しているのでそれを使うか，wordで行数を設定した時の行送りの値を参考にするという手もある？

\hypertarget{ux30d5ux30a9ux30f3ux30c8}{%
\subsection{3.8　フォント}\label{ux30d5ux30a9ux30f3ux30c8}}

　どのフォントを使うかは，preambleで指定する。luatexja-fontspecというパッケージを使い，\textbackslash setmainfontで英数字，\textbackslash setmainjfontで日本語のフォントを設定できる。なお，本稿はヒラギノ明朝
+ Times New
Romanで作成している。詳しくは公式vignette(\url{http://mirrors.ibiblio.org/CTAN/macros/luatex/generic/luatexja/doc/luatexja-ja.pdf)を参照}。
　

\theendnotes

\clearpage

\pagenumbering{roman}
\setcounter{page}{1}

\hypertarget{ux5f15ux7528ux6587ux732e}{%
\section{引用文献}\label{ux5f15ux7528ux6587ux732e}}

\begin{hangall}{2}  

ebal・北川弘典，2020，「LuaLaTex-jaの\textbackslash ltjgetparameterについて」（2021年1月10日取得
\url{https://oku.edu.mie-u.ac.jp/tex/mod/forum/discuss.php?d=2907}）．

hakuoku，2018，「カスタム字下げ・地寄せ」（2021年1月10日取得
\url{https://hakuoku.github.io/agakuTeX/tutorial/5_1flush/}）．

hnsn1202，2013，「LaTeXで脚注を文書末もしくは章末に書く手順」（2021年1月10日取得
\url{http://hnsn1202.hateblo.jp/entry/2013/02/06/170617}）．

Mugiyama
Ryota，2017，「修論LaTeXテンプレート（jsbook使用）」（2021年1月10日取得
\url{http://ryotamugiyama.com/2017/02/17/textemplate/}）．

Nigimitama，2019，「［R］RMarkdownをPDFにして論文を書くときのテンプレート」（2021年1月10日取得
\url{https://nigimitama.hatenablog.jp/entry/2019/01/13/021447}）．

\end{hangall}  

\end{document}
